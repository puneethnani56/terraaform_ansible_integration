- name: Configure Web Server
  hosts: all
  become: yes
  tasks:
    - name: Install Nginx on Ubuntu
      apt:
        name: nginx
        state: present
        update_cache: yes
      when: ansible_os_family == "Debian"

    - name: Enable Nginx via amazon-linux-extras on Amazon Linux 2
      shell: amazon-linux-extras enable nginx1
      args:
        warn: false
      when: ansible_distribution == "Amazon" and ansible_distribution_major_version == "2"

    - name: Install Nginx on Amazon Linux 2
      yum:
        name: nginx
        state: present
      when: ansible_distribution == "Amazon" and ansible_distribution_major_version == "2"

    - name: Start Nginx
      service:
        name: nginx
        state: started
        enabled: yes
